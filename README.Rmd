---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "100%"
)
```

# fars.functions

<!-- badges: start -->
[![R-CMD-check](https://github.com/haliyan/fars.functions/workflows/R-CMD-check/badge.svg)](https://github.com/haliyan/fars.functions/actions)
<!-- badges: end -->

The goal of fars.functions is to read in, summarize, and map FARS (Fatality Analysis Reporting System) data on car accidents in the United States. 

## Installation

You can install the development version of `fars.functions` in R by entering `install_github("haliyan/fars.functions")` into the console. 

*Note: Using the* `install_github` *function requires that the* `devtools` *package be installed and loaded.* `devtools` *can be installed using* `install.packages("devtools")` *and loaded using* `library(devtools)`

Once the `fars.functions` package is installed, load it using `library(fars.functions)`. 

```{r,echo=FALSE}
library(fars.functions)
library(knitr)
```


**Examples**

The fars.functions package function `make_filename` creates a FARS file name of the correct format for a certain year supplied by the user. 
This format is `accident_X.csv.bz2`, where X is the user-supplied year:

```{r}
make_filename("2013")
```


The function `fars_read` reads in a FARS file of a certain file name and creates a tibble of the data. 
```{r}
fars_read("accident_2013.csv.bz2")
```

This function can also be used together with `make_filename` and the pipe operator `%>%` from the `magrittr` package, especially if the correct file name format is not known. 

```{r}
library(magrittr)
make_filename("2013") %>% 
  fars_read()
```


The `fars_read_years` takes a list or vector of years and produces a list of tibbles. Each tibble contains the months in one of the years in the supplied vector of years. The number of rows for each month represents the number of accidents that occurred in that month.

```{r}
fars_read_years(c("2013","2014"))
```


The `fars_summarize_years` function also takes a list or vector of years and produces a single tibble. The rows of the tibble represent the 12 months in a year. The columns of the tibble are the years that were supplied to the function. The values contained in the tibble are the numbers of accidents in a particular month of a particular year. 

```{r}
fars_summarize_years(c("2013","2014"))
```


The `fars_map_state` function creates a map of accidents in a given state in a given year. For example, the following code creates a map of the accidents in the state of Wisconsin in 2014:

```{r}
fars_map_state(55, 2014) 
```


*Note: for some state numbers, the* `fars_map_state` *function will not work, for various reasons. A quick summary table of these is included below. For more details plus a full table of all 56 state numbers and corresponding state names, please see the package vignette.* 

```{r, echo=FALSE}
data.frame(Numbers = c(2,3,7,14,15,43,52), 
           Reasons = c("Alaska; out of bounds", 
             "American Samoa; no data", 
             "Canal Zone; no data",
             "Guam; no data",
             "Hawaii; out of bounds", 
             "Puerto Rico; no data", 
             "Virgin Islands; no data")) %>% 
  kable()
```

**License**

GPL 
